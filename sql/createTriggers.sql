FILES_CREATED_AI
BEGIN
    IF :NEW.PRODUCER = 'StorageManager' THEN
	INSERT INTO FILES_INFO ( FILENAME,
				 HOSTNAME,
				 SETUPLABEL,
				 STREAM,
				 RUNNUMBER,
				 LUMISECTION,
				 CREATED_TIME )
	VALUES ( :NEW.FILENAME,
		 :NEW.HOSTNAME,
		 :NEW.SETUPLABEL,
		 :NEW.STREAM,
		 :NEW.RUNNUMBER,
		 :NEW.LUMISECTION,
		 :NEW.CTIME );
    END IF;

END;

FILES_DELETED_AI
BEGIN
    UPDATE FILES_INFO
       SET DELETED_TIME = :NEW.DTIME,
	   STATE = 99
     WHERE FILENAME = :NEW.FILENAME;
    IF SQL%ROWCOUNT = 0 THEN
	NULL;
    END IF;

END;

FILES_INJECTED_AI
BEGIN
    UPDATE FILES_INFO
       SET NEVENTS = :NEW.NEVENTS,
	   FILESIZE = :NEW.FILESIZE,
	   INJECTED_TIME = :NEW.ITIME,
	   STATE = 1
     WHERE FILENAME = :NEW.FILENAME
       AND STATE = 0;
    IF SQL%ROWCOUNT = 0 THEN
	NULL;
    END IF;

END;

FILES_TRANS_CHECKED_AI
BEGIN
    UPDATE FILES_INFO
       SET CHECKED_TIME = :NEW.ITIME,
	   STATE = 30
     WHERE FILENAME = :NEW.FILENAME;                        --	AND STATE >= 10 AND  STATE < 30
    IF SQL%ROWCOUNT = 0 THEN
	NULL;
    END IF;

END;

FILES_TRANS_COPIED_AI
BEGIN
    UPDATE FILES_INFO
       SET COPIED_TIME = :NEW.ITIME,
	   STATE = 20
     WHERE FILENAME = :NEW.FILENAME;                        --	AND STATE >= 10 AND  STATE < 20
    IF SQL%ROWCOUNT = 0 THEN
	NULL;
    END IF;

END;

FILES_TRANS_COPIED_AI
BEGIN
    UPDATE FILES_INFO
       SET INSERTED_TIME = :NEW.ITIME,
	   STATE = 40
     WHERE FILENAME = :NEW.FILENAME;                        --	AND STATE >= 10 AND  STATE < 40
    IF SQL%ROWCOUNT = 0 THEN
	NULL;
    END IF;

END;

FILES_TRANS_NEW_AI
BEGIN
    UPDATE FILES_INFO
       SET NEW_TIME = :NEW.ITIME,
	   STATE = 10
     WHERE FILENAME = :NEW.FILENAME;                        --AND STATE >= 1 AND STATE < 10
    IF SQL%ROWCOUNT = 0 THEN
	NULL;
    END IF;

END;

FILES_TRANS_REPACKED_AI
BEGIN
    UPDATE FILES_INFO
       SET REPACKED_TIME = :NEW.ITIME,
	   STATE = 50
     WHERE FILENAME = :NEW.FILENAME;                        --	AND STATE >= 10 AND  STATE < 50
    IF SQL%ROWCOUNT = 0 THEN
	NULL;
    END IF;

END;
